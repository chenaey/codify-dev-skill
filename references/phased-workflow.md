# 分步实现流程

> 当骨架显示多个独立区域时，使用此流程。

---

## 核心约束

**禁止一次性生成所有代码。**

必须：先理解 → 再规划 → 逐个思考 → 逐个实现

---

## Phase 1: 理解骨架

获取骨架后，**先输出你的理解**：

```markdown
## 骨架理解

**整体结构**：
- 根容器包含 N 个主要区域
- 布局方向：垂直排列 / 水平排列 / 混合

**识别到的区域**：
1. 节点 13:4000 [V] - 看起来是...
2. 节点 13:4382 [H] - 看起来是...
3. ...

**重复模式**：
- 节点 13:4382 下有 ×3 重复，可能是列表/卡片/选项

**不确定的部分**：
- 节点 XX 的用途不明确，需要结合截图或获取详细 JSON 确认
```


---

## Phase 2: 制定实现计划

创建 `implementation-plan.md`，包含**组件规划**和**实现思路**：

```markdown
# 实现计划

## 组件列表

| 组件 | 节点 ID | 功能描述 | 特殊处理 | 依赖 | 状态 |
|------|---------|---------|---------|------|------|
| Header | 13:4000 | 顶部导航区域 | 可能有固定定位 | - | ⬜ |
| CardList | 13:4382 | 横向卡片列表 | 包含 ×3 重复，需提取模板 | Card | ⬜ |
| Card | (子节点) | 单个卡片 | 是 CardList 的模板 | - | ⬜ |
| Footer | 17:6940 | 底部信息 | - | - | ⬜ |

## 实现顺序

1. **Card** - 先实现子组件，被 CardList 依赖
2. **CardList** - 使用 Card 组件
3. **Header** - 独立区域
4. **Footer** - 独立区域
5. **Page** - 组装所有组件

## 组件详细描述

### Card (子节点 of 13:4382)
- **结构**：ICON + TEXT 组合
- **预期实现**：图标 + 文字横排，可能有点击态
- **注意**：图标需下载 SVG

### CardList (13:4382)
- **结构**：水平布局容器，包含 3 个 Card
- **预期实现**：flex 横向排列，可能有 gap
- **数据**：接收 items 数组，循环渲染 Card

### Header (13:4000)
- **结构**：垂直布局，标题 + 描述
- **预期实现**：简单的标题组件
- **注意**：检查是否有背景色或分割线

### Footer (17:6940)
- **结构**：简单文本区域
- **预期实现**：底部信息展示
```

**计划要素说明**：

| 字段 | 作用 |
|------|------|
| 功能描述 | 这个组件做什么（不是长什么样） |
| 特殊处理 | 需要特别注意的点（重复、定位、资源下载） |
| 依赖 | 是否依赖其他组件 |
| 实现顺序 | 被依赖的先实现 |
| 预期实现 | 用自然语言描述代码思路 |

---

## Phase 3: 逐个实现

按计划顺序，对每个组件：

### 3.1 获取 JSON

```bash
curl -s -X POST http://127.0.0.1:13580/get_design \
  -H "Content-Type: application/json" \
  -d '{"node_id": "13:4382"}'
```

### 3.2 分析 JSON 复杂度

**如果 JSON 还是很复杂**（≥10 层嵌套或多个子区域）：

```markdown
## CardList JSON 分析

JSON 显示该组件内部结构复杂：
- 每个 Card 内部还有嵌套
- 需要进一步拆分

**调整计划**：
- Card 组件再拆分为 CardIcon + CardContent
```

> 可以递归应用本流程，直到每个组件足够清晰简洁, 符合组件设计最佳实践。

### 3.3 实现前描述

**在写代码之前**，先描述实现思路：

```markdown
## Card 实现描述

**结构**：
- 外层容器：flex 横向
- 左侧：24x24 图标，从 assets 下载
- 右侧：文本，从 text.content 提取

**样式来源**：
- 容器 padding：customStyle.padding
- gap：customStyle.gap
- 文本颜色：customStyle.color

**资源**：
- 图标节点 ID：13:4500，需下载 SVG
```

### 3.4 生成代码

遵循 [codegen-rules.md](codegen-rules.md) 生成代码。

### 3.5 更新计划

```markdown
| Card | (子节点) | 单个卡片 | ... | - | ✅ |
```

---

## Phase 4: 组装

所有组件完成后：

1. 创建页面入口，组合组件
2. 检查组件间的 props 传递
3. 验证整体结构与骨架一致

---

## 检查清单

实现过程中持续检查：

- [ ] 是否先输出了骨架理解？
- [ ] 是否创建了包含"功能描述"和"特殊处理"的实现计划？
- [ ] 依赖组件是否先实现？
- [ ] 每个组件实现前是否有"实现描述"？
- [ ] 复杂 JSON 是否进一步拆分？
- [ ] 所有 ×N 重复都用循环而非复制？